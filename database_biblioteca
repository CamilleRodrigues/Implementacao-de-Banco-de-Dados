CREATE DATABASE BIBLIOTECA;
USE BIBLIOTECA;

/* biblioteca_logico: */
CREATE TABLE LIVRO (
    ISBN VARCHAR(50) PRIMARY KEY,
    titulo VARCHAR(100),
    ano INT,
    FK_EDITORA_id INT,
    FK_CATEGORIA_codigo INT
);

CREATE TABLE AUTOR (
    nacionalidade VARCHAR(50),
    id INT PRIMARY KEY IDENTITY,
    nome VARCHAR(50)
);

CREATE TABLE EDITORA (
    nome VARCHAR(100),
    id INT PRIMARY KEY IDENTITY
);

CREATE TABLE CATEGORIA (
    descricao VARCHAR(50),
    codigo INT PRIMARY KEY IDENTITY
);

CREATE TABLE LIVRO_AUTOR_ESCRITO (
    FK_LIVRO_ISBN VARCHAR(50),
    FK_AUTOR_id INT
);
 
ALTER TABLE LIVRO ADD CONSTRAINT FK_LIVRO_2
    FOREIGN KEY (FK_EDITORA_id)
    REFERENCES EDITORA (id)
    ON DELETE CASCADE;
 
ALTER TABLE LIVRO ADD CONSTRAINT FK_LIVRO_3
    FOREIGN KEY (FK_CATEGORIA_codigo)
    REFERENCES CATEGORIA (codigo)
    ON DELETE CASCADE;
 
ALTER TABLE LIVRO_AUTOR_ESCRITO ADD CONSTRAINT FK_LIVRO_AUTOR_ESCRITO_1
    FOREIGN KEY (FK_LIVRO_ISBN)
    REFERENCES LIVRO (ISBN);
 
ALTER TABLE LIVRO_AUTOR_ESCRITO ADD CONSTRAINT FK_LIVRO_AUTOR_ESCRITO_2
    FOREIGN KEY (FK_AUTOR_id)
    REFERENCES AUTOR (id);


INSERT INTO CATEGORIA (descricao) VALUES ('Literatura Juvenil');

SELECT C.codigo, C.descricao
FROM CATEGORIA AS C
WHERE C.descricao LIKE '%Juve%';
